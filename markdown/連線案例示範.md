## 案例示範:

案例需求: 1.在首頁選擇建立伺服器(按下Enter)；或連接伺服器(按下Space)

​                  2.多人連線後，可以看見各自的角色行走。

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/7f10da9e-11de-4e0c-acc7-1f5c0461348e/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210412%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210412T011309Z&X-Amz-Expires=86400&X-Amz-Signature=86bb619df9fc2ea5581ebe922d59eb863a2daaaba3dd8401f1e785ee416cada0&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/61896fa0-843d-43d1-962b-d5fd0dc36168/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210412%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210412T012510Z&X-Amz-Expires=86400&X-Amz-Signature=21ef16b63c5e7eb0d43259a1bb3367feb9799e1b4fe6eee23f6dbd0e9b0a5e91&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

## 第一步:首頁的連線設置和基礎設置

### 1.在OpenScene設置創立伺服器 或 連接伺服器

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/e50df0d1-b1c7-4645-942b-3d3ce48b3e11/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T120649Z&X-Amz-Expires=86400&X-Amz-Signature=27fb9bd52b7009037f60f233a67f5b819e108348f34c498840852d5a5c99cf18&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

### 2.為Actor加入ID屬性:

​    由於Server類會為每位加入的玩家配發一組ID，此範例我們在玩家控制的角色加入ID屬性，接收伺服器配發的ID以**標示玩家**。

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/6a07dcb2-5d54-407a-9d46-57033e8dafd2/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T120922Z&X-Amz-Expires=86400&X-Amz-Signature=ee70d360fb426ba53f62e8d2ce3bffc67fff89948f14238816eee144f2a5a5f4&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

## 第二步:遊戲主場景的設置-傳送和接收訊息

### 1.在遊戲場景中加入Actor的集合:

如此才可以在有別人加進來時，將他的角色加入到自己的ArrayList中，並出現在場景。

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/4ee2d64a-c973-4bdb-b72f-945b9f4d456e/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T124725Z&X-Amz-Expires=86400&X-Amz-Signature=62cc2aa7de279dc3ed2c9706ff704c8a4d5dbb2758f509cdf0ab756e8770f147&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

### 2.設置InternetCommand

​	可以在Global中設置InternetCommand，目前需求為連接玩家並看的見移動，然後離開時會斷線。

​	所以設置三個指令CONNECT  MOVE  DISCONNECT。將來有更多邏輯時，要視需求擴充，例如射擊遊戲就會有SHOT指令。

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/82e4d88a-656e-4814-87fa-8b7def3b019b/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T124910Z&X-Amz-Expires=86400&X-Amz-Signature=145b1a4ac9c8f4770a89cbef57d25c904a5a4eceaff08430804a0d2343eb6f60&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

### 3.主場景中傳送和接收指令:

​      主要兩個步驟: 1.發送自己角色的訊息  2.接收並解析別人角色的連接 移動 斷線等訊息

#### - 發送訊息

(1)**在update中發送自己的ID 中心點座標x y 移動方向**

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/cdc2133c-2b4d-4e65-9bde-050d7a5e5a41/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T125251Z&X-Amz-Expires=86400&X-Amz-Signature=a596b246ec9494ffe09b0f6c0feb32ade27d4822f6490c33474854dbb55416cf&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

(2)在鍵盤監聽中發送斷線訊息:

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/2b301437-abd0-4e76-bfba-2bb618b413bc/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T125353Z&X-Amz-Expires=86400&X-Amz-Signature=75af75d2a8e28572540adf1aa6157e4cd1db890ef39c49e35e6f70361c882497&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

#### - 接收訊息

接收並解析別人角色的連接 移動 斷線等訊息。這部分將會很長，藉由ClinetClass中的consume方法，就可以依據我們在Global中設置的InternetCommand，搭配switchCase來設定三種狀態下要解析的外來訊息。

(1)完成CONNCENT指令的處理邏輯

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/f1ad289c-b4c6-46e8-b683-cd402ae48ebd/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T125620Z&X-Amz-Expires=86400&X-Amz-Signature=aabf7223a48c3fcb6d5f4925e188db08f989f81e42aea6d7b73ced698936adea&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

​                                                   ps.您現在的位置在update中的consume中的receive匿名內部類中的switchCase中。

(2)完成MOVE指令的處理邏輯

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a0495572-c9d7-4226-95c2-7f2938edce55/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T125646Z&X-Amz-Expires=86400&X-Amz-Signature=f66e1da6990b38bd74f7c05efda65b23704ee25aeacffd074d24e4da4c63155e&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

(3)完成DISCONNENT的處理邏輯

接收到有人斷現的訊息時，就從我們的Actor陣列中比對ID，移除該Actor。

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/76d9a5b9-e040-43f5-a4f9-9b0c37c42620/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T125659Z&X-Amz-Expires=86400&X-Amz-Signature=bc4a8306fffa112cb416eddda20f682ac985849de9db74215f120f9956424280&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

### 4. 最後的主場景繪製

​		記得在paint中把大家的角色都畫出來

![img](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/752024c4-0a1f-441e-8c52-1ded2ecb33af/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210411%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20210411T125801Z&X-Amz-Expires=86400&X-Amz-Signature=f0546718177bf5c0dd77c845736acb53fa243b5a1582ef8793e5833171b15922&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22)

